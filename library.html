<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lynn Museum & Arts Center - Library</title>
  <link rel="stylesheet" href="res/style.css">
  <!-- Favicon -->
  <link rel="icon" href="res/favicon.ico" type="image/x-icon">
  <style>
    :root {
      --primary-color: #0077cc;
      --secondary-color: #005599;
      --background-color: #84c5ff;
      --text-color: #000;
      --button-hover: #004477;
    }
    body.dark-mode {
      --background-color: #1e1e1e;
      --text-color: white;
      --primary-color: #00aaff;
      --secondary-color: #0088cc;
      --button-hover: #0077cc;
    }
    body {
      font-family: Arial, sans-serif;
      background-color: var(--background-color);
      color: var(--text-color);
      text-align: center;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: var(--secondary-color);
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    nav ul {
      list-style: none;
      padding: 0;
      display: flex;
      gap: 20px;
    }
    nav ul li {
      display: inline;
    }
    nav ul li a {
      text-decoration: none;
      color: white;
      font-size: 18px;
      transition: color 0.3s ease;
    }
    nav ul li a:hover {
      color: var(--primary-color);
    }
    .settings-menu {
      position: relative;
      display: inline-block;
    }
    .settings-menu button {
      background-color: var(--secondary-color);
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
      font-size: 16px;
    }
    .settings-dropdown {
      display: none;
      position: absolute;
      right: 0;
      background-color: var(--secondary-color);
      min-width: 150px;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 1;
    }
    .settings-dropdown a, .settings-dropdown button {
      display: block;
      color: white;
      padding: 10px;
      text-align: left;
      width: 100%;
      background: none;
      border: none;
      cursor: pointer;
    }
    .settings-dropdown a:hover, .settings-dropdown button:hover {
      background-color: var(--button-hover);
    }
    .settings-menu:hover .settings-dropdown {
      display: block;
    }
    main {
      padding: 40px 20px;
    }
    .library-content {
      margin-top: 40px;
    }
    /* ---------- New Styles for the Interactive Map ---------- */
    #map-container {
      width: 80%;
      max-width: 800px;
      margin: 40px auto; /* Center the container */
      border: 1px solid #ccc;
      position: relative;
      overflow: hidden; /* Hide overflow when zooming/panning */
      background-color: #fff;
    }
    /* We use a dedicated wrapper to hold the SVG (so our tooltip remains separate) */
    #svg-wrapper {
      width: 100%;
      height: auto;
      cursor: grab;
    }
    #svg-wrapper svg {
      width: 100%;
      height: auto;
    }
    #svg-wrapper:active {
      cursor: grabbing;
    }
    /* Tooltip styling */
    #tooltip {
      position: absolute;
      padding: 6px 10px;
      background-color: #333;
      color: #fff;
      font-size: 14px;
      border-radius: 4px;
      pointer-events: none; /* Don't block mouse events */
      display: none;        /* Hidden by default */
      z-index: 999;
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="library.html">Library</a></li>
        <li><a href="#">Basement</a></li>
        <li><a href="reference.html">Reference Guide</a></li>
        <li><a href="#">How to: Historical Research</a></li>
        <li><a href="https://trello.com/b/1YoJWfHl/archive-work" target="_blank">Trello</a></li>
        <li><a href="https://lynnmuseum.org/" target="_blank">Lynn Museum</a></li>
        <li><a href="about.html">About</a></li>
      </ul>
    </nav>
    <div class="settings-menu">
      <button>Settings â–¼</button>
      <div class="settings-dropdown">
        <button id="toggle-dark-mode">Toggle Dark Mode</button>
      </div>
    </div>
  </header>
  
  <main>
    <!-- Interactive Map Section -->
    <section class="map-section">
      <h2>Interactive Library Map</h2>
      <div id="map-container">
        <!-- SVG will be loaded into this wrapper -->
        <div id="svg-wrapper"></div>
        <!-- Tooltip (appears on hover) -->
        <div id="tooltip"></div>
      </div>
    </section>
  </main>
  
  <!-- Panzoom library from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@panzoom/panzoom@4.4.3/dist/panzoom.min.js"></script>
  
  <script>
    // Dark Mode toggle
    document.getElementById('toggle-dark-mode').addEventListener('click', function() {
      document.body.classList.toggle('dark-mode');
    });

    // Fetch the external SVG file for the library floor plan
    fetch('res/library_floorplan.svg')
      .then(response => response.text())
      .then(svgData => {
        // Insert the fetched SVG into the wrapper
        const svgWrapper = document.getElementById('svg-wrapper');
        svgWrapper.innerHTML = svgData;
        
        // Get the inserted SVG element and assign an ID for later use
        const svgElement = svgWrapper.querySelector('svg');
        svgElement.id = 'map-svg';
        
        // Initialize Panzoom on the SVG element
        const panzoomInstance = Panzoom(svgElement, {
          maxScale: 5,      // Maximum zoom-in level
          minScale: 0.1,    // Minimum zoom-out level
          contain: 'outside'
        });
        svgElement.parentElement.addEventListener('wheel', panzoomInstance.zoomWithWheel);
        
        // Tooltip logic for elements within the SVG
        const tooltip = document.getElementById('tooltip');
        // Ensure that the SVG has individual interactive elements with class 'hover-area'
        const hoverAreas = svgElement.querySelectorAll('.hover-area');
        hoverAreas.forEach(area => {
          // Show tooltip on mouseenter
          area.addEventListener('mouseenter', () => {
            tooltip.textContent = area.dataset.label;
            tooltip.style.display = 'block';
          });
          // Position tooltip near the mouse
          area.addEventListener('mousemove', (e) => {
            tooltip.style.top = (e.pageY + 10) + 'px';
            tooltip.style.left = (e.pageX + 10) + 'px';
          });
          // Hide tooltip when leaving the area
          area.addEventListener('mouseleave', () => {
            tooltip.style.display = 'none';
          });
        });
      })
      .catch(err => {
        console.error('Error loading the SVG file:', err);
      });
  </script>
</body>
</html>
